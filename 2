from flask import Flask, render_template, request, make_response
import requests
app = Flask(__name__, template_folder = 'templates') 

def territories(file_name):
    with open(file_name) as f:
        location = f.read().splitlines()
    return [{"value":territoy, "text":territoy} for territoy in location]


@app.route('/') 
def index(): 
    return render_template('index.html', canada=territories('locations/Canada'), us_states=territories('locations/US')) 

@app.route('/process_selection', methodds=['POST'])
def process_selection():
    selected_territories = request.form.getlist('selected_territories')
    print(selected_territories


@app.route('/result', methods = ['POST'])
def result():
    if request.method == 'POST':
        name = request.form['name']
        lisc = request.form['license']
        ssn = request.form['ssn']

    burp0_url = "https://mgmresorts.logscale.us-2.crowdstrike.com:443/api/v1/repositories/2023edw/query/"
    burp0_headers = {"Authorization": "bearer SPVO5jlbcJODBc8s2jVB7wytC2wfkEWg~NrQqGmpYVNYEi5HGUu45OzSBgcTOrXBkO5AhYysQrqaR", "Content-Type": "application/json"}
    burp0_json={"end": "now", "queryString":f"driver_license ={lisc}" ,"start": 0}
    result = requests.post(burp0_url, headers=burp0_headers, json=burp0_json)

    resp = result.content
    
    return resp



if __name__ == '__main__':
    app.run(debug=True)
